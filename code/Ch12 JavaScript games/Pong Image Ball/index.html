<!DOCTYPE html>
<html>

<head>
  <title>Just Pong</title>
</head>

<body>
  <canvas id="canvas" width="800" height="600">
    This browser does not support a canvas.
  </canvas> 
  <script>


    class Sprite
    {
      constructor(imagePath, ctx, x, y, width, height)
      {
        this.loaded = false;
        this.image = new Image();
        this.image.onload = function()
        {
          this.loaded = true;
        }
        this.image.src = imagePath;
        this.ctx = ctx;
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
      }

      draw()
      {
        this.ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
      }

      update()
      {

      }
    }

    class BallSprite extends Sprite{
        constructor(imagePath, ctx, x, y, width, height,xSpeed, ySpeed, boxX, boxY)
        {
          super(imagePath, ctx, x, y, width, height);
          this.boxX = boxX;
          this.boxY = boxY;
          this.xSpeed = xSpeed;
          this.ySpeed = ySpeed; 
        }

        update()
        {
          super.update();
          this.x += this.xSpeed;
          this.y += this.ySpeed;
          if((this.x+this.width)>this.boxX) this.xSpeed = Math.abs(this.xSpeed) * -1;
          if(this.x<0) this.xSpeed = Math.abs(this.xSpeed);
          if((this.y+this.height)>this.boxY) this.ySpeed = Math.abs(this.ySpeed) * -1;
          if(this.y<0) this.ySpeed = Math.abs(this.ySpeed);
        }
    }

    function clearScreen()
    {
      window.ctx.fillStyle = "blue";
      window.ctx.fillRect(0,0,canvas.width,canvas.height);
    }
    
    function updateSprite(sprite)
    {
      sprite.X = sprite.X + sprite.XSpeed;
      sprite.Y = sprite.Y + sprite.Yspeed;
    }

    function updateGame()
    {
      window.ball.update();
    }

    function drawGame(timestamp)
    {
      clearScreen();
      window.ball.draw();
    }

    function runGame()
    {
      updateGame();
      drawGame();
//      window.requestAnimationFrame(drawGame);
      setTimeout( runGame, 10);
    }

    function init()
    {
      var canvas = document.getElementById("canvas");

      if(canvas.getContext)
      {
        window.ctx = canvas.getContext("2d");
        window.ball = new BallSprite("images/ball.png",window.ctx, 0,0,30,30,4,4,800,600);
        clearScreen();
      }
      else
      {
        alert("No canvas available");
      }

      runGame();
    }
    onload = init;
  </script>
</body>

</html>